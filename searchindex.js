Search.setIndex({"docnames": ["downloads", "faq", "file_format", "index", "notebooks/quickstart", "reference", "reference/scdrs.method._pearson_corr", "reference/scdrs.method._pearson_corr_sparse", "reference/scdrs.method.downstream_corr_analysis", "reference/scdrs.method.downstream_gene_analysis", "reference/scdrs.method.downstream_group_analysis", "reference/scdrs.method.gearys_c", "reference/scdrs.method.test_gearysc", "reference/scdrs.pp._get_mean_var", "reference/scdrs.pp._get_mean_var_implicit_cov_corr", "reference/scdrs.pp.compute_stats", "reference/scdrs.pp.reg_out", "reference/scdrs.preprocess", "reference/scdrs.score_cell", "reference/scdrs.util.load_gs", "reference/scdrs.util.load_h5ad", "reference/scdrs.util.load_homolog_mapping", "reference/scdrs.util.load_scdrs_score", "reference_cli", "versions"], "filenames": ["downloads.rst", "faq.rst", "file_format.rst", "index.rst", "notebooks/quickstart.ipynb", "reference.rst", "reference/scdrs.method._pearson_corr.rst", "reference/scdrs.method._pearson_corr_sparse.rst", "reference/scdrs.method.downstream_corr_analysis.rst", "reference/scdrs.method.downstream_gene_analysis.rst", "reference/scdrs.method.downstream_group_analysis.rst", "reference/scdrs.method.gearys_c.rst", "reference/scdrs.method.test_gearysc.rst", "reference/scdrs.pp._get_mean_var.rst", "reference/scdrs.pp._get_mean_var_implicit_cov_corr.rst", "reference/scdrs.pp.compute_stats.rst", "reference/scdrs.pp.reg_out.rst", "reference/scdrs.preprocess.rst", "reference/scdrs.score_cell.rst", "reference/scdrs.util.load_gs.rst", "reference/scdrs.util.load_h5ad.rst", "reference/scdrs.util.load_homolog_mapping.rst", "reference/scdrs.util.load_scdrs_score.rst", "reference_cli.rst", "versions.rst"], "titles": ["Downloads", "FAQ", "File formats", "scDRS", "Quick start", "Documentation", "scdrs.method._pearson_corr", "scdrs.method._pearson_corr_sparse", "scdrs.method.downstream_corr_analysis", "scdrs.method.downstream_gene_analysis", "scdrs.method.downstream_group_analysis", "scdrs.method.gearys_c", "scdrs.method.test_gearysc", "scdrs.pp._get_mean_var", "scdrs.pp._get_mean_var_implicit_cov_corr", "scdrs.pp.compute_stats", "scdrs.pp.reg_out", "scdrs.preprocess", "scdrs.score_cell", "scdrs.util.load_gs", "scdrs.util.load_h5ad", "scdrs.util.load_homolog_mapping", "scdrs.util.load_scdrs_score", "CLI", "Versions"], "terms": {"figshar": [0, 4], "detail": [0, 1, 4, 23], "scdrs_paper": 0, "weight": [0, 13, 14, 15, 17, 18, 19, 23], "gwa": [0, 2, 4, 23], "gene": [0, 2, 4, 9, 15, 17, 18, 19, 21, 23], "set": [0, 2, 3, 17, 18, 19, 23], "g": [0, 1, 3, 4, 8, 17, 19, 22], "file": [0, 1, 3, 4, 8, 9, 10, 18, 19, 20, 22, 23], "74": [0, 3], "diseas": [0, 1, 2, 3, 8, 9, 12, 18, 23], "complex": 0, "trait": [0, 1, 3, 4, 8, 9, 10, 12, 19, 22, 23], "scdr": [0, 2, 23, 24], "us": [0, 2, 3, 8, 10, 15, 17, 18, 22, 23], "score": [0, 3, 8, 9, 12, 18, 22], "gz": [0, 1, 4, 22, 23], "full_scor": [0, 1, 4, 8, 9, 10, 22, 23], "tm": [0, 3, 23], "fac": [0, 3], "latest": 0, "revis": 0, "1": [0, 1, 2, 3, 4, 10, 11, 13, 14, 17, 18, 23], "binari": 0, "initi": 0, "submiss": 0, "here": [1, 3, 4], "some": [1, 4], "frequent": 1, "ask": 1, "question": 1, "about": [1, 4], "from": [1, 2, 4, 11, 18, 23], "gener": [1, 2, 23], "level": [1, 2, 8, 9, 10, 12, 15, 17, 18, 23], "given": [1, 2, 4, 8, 9, 10, 23], "pval_fil": [1, 23], "zscore_fil": [1, 23], "summari": [1, 2, 4], "statist": [1, 2, 10, 11, 12, 15, 17, 18, 23], "cli": [1, 2, 3, 4], "mung": [1, 2], "individu": [1, 3, 8, 18, 23], "result": [1, 2, 3, 4, 8, 9, 12, 18, 23], "input": [1, 19], "h5ad": [1, 3, 4, 20, 23], "covari": [1, 2, 4, 15, 16, 17, 18, 23], "cov": [1, 3, 4, 17, 23], "output": [1, 18, 23], "full": [1, 2, 22, 23], "perform": [1, 4, 15, 17, 20], "downstream": 1, "analys": [1, 3, 23], "associ": [1, 2, 3, 4, 8, 10, 18, 23], "b": [1, 24], "within": [1, 2, 23], "heterogen": [1, 2, 4, 10, 23], "c": [1, 2, 11, 12, 23], "correl": [1, 2, 4, 6, 7, 8, 9, 23], "variabl": [1, 2, 8, 12, 16, 18, 23], "d": 1, "express": [1, 4, 15, 17, 19, 23], "custom": [1, 2, 3], "code": [1, 2, 3, 4], "test": [1, 2, 3, 8, 12, 23, 24], "normal": [1, 2, 8, 9, 10, 15, 17, 18, 20, 23], "across": [1, 2, 4, 23], "same": [1, 2, 4, 18, 21], "each": [1, 4, 9, 10, 17, 23], "n_ctrl": [1, 2, 3, 4, 18, 23], "control": [1, 2, 4, 8, 12, 15, 17, 18, 23], "pvalu": 1, "exceed": 1, "annot": [1, 4, 8, 10, 14, 17, 23], "store": [1, 15, 17], "adata": [1, 2, 3, 4, 8, 9, 10, 11, 12, 14, 15, 17, 20, 23], "ob": [1, 2, 4, 8, 10, 17, 23], "base": [1, 8, 17, 18, 23], "To": [1, 4], "ensur": 1, "reason": 1, "number": [1, 2, 4, 14, 15, 17, 18, 23], "discoveri": 1, "we": [1, 4], "recommend": [1, 10], "herit": 1, "greater": 1, "5": [1, 2, 3, 4, 17, 23], "sampl": [1, 23], "100k": 1, "also": [1, 4], "divers": 1, "potenti": 1, "relev": [1, 3], "although": 1, "smaller": 1, "should": [1, 2, 11, 15, 17, 18, 22, 23], "affect": 1, "power": 1, "pleas": 1, "see": [1, 4, 23], "instruct": 1, "ye": 1, "you": [1, 4], "can": [1, 2, 4, 13], "instead": [1, 17], "identifi": [1, 2, 23], "excess": 1, "The": [1, 4, 12, 17, 23], "have": [1, 4, 11, 17], "moder": 1, "e": [1, 2, 3, 8, 17, 19, 22, 23, 24], "50": [1, 4, 20, 23], "20": [1, 2, 3, 4, 10, 14, 15, 17, 23], "all": [1, 2, 4, 23], "valid": [1, 4], "In": [1, 4, 15, 17], "practic": 1, "observ": [1, 4], "long": 1, "i": [1, 3, 4, 10, 11, 12, 15, 17, 18, 23], "10": [1, 2, 3, 4, 22], "method": [1, 3, 4], "zhang": [1, 3], "hou": [1, 3], "et": [1, 3, 4], "al": [1, 3, 4], "nat": 1, "genet": 1, "2022": 1, "scale": [1, 4, 15, 17], "linearli": 1, "both": [1, 18, 23], "memori": [1, 14, 17], "It": [1, 15, 17, 18], "take": [1, 4], "around": 1, "3": [1, 2, 3, 4, 23], "hour": 1, "60gb": 1, "million": 1, "mai": [1, 4], "underpow": 1, "certain": 1, "case": [1, 4, 15, 18], "ensu": 1, "still": 1, "suffici": 1, "becaus": 1, "aggreg": 1, "henc": 1, "higher": 1, "assess": [1, 4, 8, 23], "ha": [1, 15], "suggest": [1, 4], "an": [1, 4, 11, 23], "addit": 1, "help": [1, 4, 23], "visual": [1, 4], "inspect": 1, "umap": [1, 4], "plot": [1, 4], "local": [1, 4], "enrich": [1, 3], "high": 1, "usual": 1, "indic": [1, 4], "interest": [1, 4], "biolog": 1, "signal": [1, 4], "increas": [1, 23], "n": [1, 2, 6, 7, 11, 23], "ctrl": [1, 4, 23], "produc": [1, 23], "altern": [1, 4], "assoc_mcz": [1, 2, 4], "when": [1, 4, 14, 15, 17, 23], "assoc_mcp": [1, 2, 4], "small": 1, "As": 1, "mention": 1, "section": [1, 3], "our": [1, 3, 4], "manuscript": [1, 3, 4], "determin": [1, 14], "further": [1, 4], "priorit": [1, 23], "whose": 1, "reach": 1, "tailor": 1, "best": 1, "systemat": 1, "comparison": 1, "remain": 1, "futur": 1, "direct": 1, "empir": 1, "work": 1, "rna": [1, 3], "like": [1, 4, 11], "spatial": [1, 4], "transcriptom": 1, "dna": 1, "methyl": 1, "atac": 1, "principl": 1, "need": [1, 18], "python": [1, 3, 24], "do": 1, "thi": [1, 4, 14, 15, 22, 23], "right": [1, 4], "after": 1, "call": [1, 23], "preprocess": [1, 3, 4, 18], "categor": 1, "atac_match": 1, "your": 1, "match": [1, 15, 17, 18, 19], "criteria": 1, "divid": [1, 18], "featur": [1, 4], "peak": 1, "discret": 1, "bin": [1, 4, 15, 17, 18], "per": [1, 2, 23], "mean": [1, 2, 4, 12, 13, 14, 15, 17], "access": 1, "gc": 1, "content": 1, "done": 1, "gchromvar": 1, "score_cel": [1, 3, 4], "tell": 1, "ctrl_match_kei": [1, 4, 18], "scatac": 1, "ulirsch": 1, "2019": 1, "chiou": 1, "2021": 1, "yu": 1, "biotechnol": 1, "follow": [2, 4, 23], "ldsc": 2, "bmi": [2, 23], "height": [2, 4, 23], "snp": 2, "a1": 2, "a2": 2, "chisq": 2, "z": [2, 18, 23], "rs7899632": 2, "A": [2, 23], "59957": 2, "4299": 2, "852": 2, "rs3750595": 2, "3124": 2, "82": 2, "singl": [2, 3, 8, 9, 10, 15, 17, 18, 20, 23], "cell": [2, 3, 8, 9, 10, 12, 15, 17, 18, 20, 22, 23], "data": [2, 3, 8, 9, 10, 13, 14, 15, 17, 18, 20, 23], "defin": [2, 10], "anndata": [2, 3, 4, 8, 9, 10, 11, 12, 14, 15, 17, 18, 20], "scanpi": [2, 3, 4, 11, 23], "p": [2, 3, 4, 18, 23, 24], "valu": [2, 4, 11, 17, 18, 23], "differ": 2, "tsv": [2, 4, 23], "first": [2, 4, 6, 7, 18, 23], "column": [2, 4, 6, 7, 8, 10, 12, 17, 18, 19, 23], "correspond": [2, 15, 17, 23], "other": [2, 3, 23], "one": [2, 11, 18, 23], "or4f5": [2, 23], "0": [2, 3, 4, 10, 13, 14, 15, 17, 18, 23], "001": [2, 4, 23], "01": [2, 23], "daz3": [2, 23], "two": [2, 15, 19], "geneset": [2, 4, 19], "line": [2, 3], "comma": [2, 19, 23], "separ": [2, 19, 23], "list": [2, 8, 10, 18, 19, 22], "pair": [2, 4], "form": [2, 14], "gene1": [2, 19], "weight1": [2, 19], "gene2": [2, 19], "weight2": [2, 19], "ar": [2, 4, 17, 18, 23], "pass_hba1c": 2, "fn3krp": 2, "2": [2, 3, 4, 10, 11, 15, 17], "fn3k": 2, "hk1": 2, "4": [2, 3, 4, 12], "7": [2, 3, 4, 15, 17], "gck": 2, "pass_medicationuse_wu2019": 2, "fto": 2, "sec16b": 2, "6": [2, 3, 4], "adcy3": 2, "dnajc27": 2, "name": [2, 4, 8, 10, 12, 19, 22, 23], "consist": [2, 4, 23], "obs_nam": [2, 22], "comlumn": 2, "numer": 2, "index": [2, 3, 4], "const": 2, "n_gene": [2, 8, 9, 10, 15, 17, 18], "sex_mal": 2, "ag": 2, "a10_b000497_b009023_s10": 2, "2706": 2, "18": 2, "2501": 2, "24": 2, "give": [2, 18], "raw_scor": [2, 3, 18], "raw": [2, 4, 18, 23], "norm_scor": [2, 3, 4, 12, 18], "mc_pval": [2, 3, 18], "mc": [2, 23], "without": [2, 23], "multipl": [2, 22, 23], "adjust": [2, 17, 23], "pval": [2, 3, 4, 12, 18, 23], "nlog10_pval": [2, 3, 18], "log10": [2, 18], "zscore": [2, 3, 12, 18, 23], "convert": [2, 4, 14, 18, 23], "730": 2, "04": [2, 4], "0476": 2, "00166": 2, "78": 2, "94": 2, "a10_b000756_b007446_s10": 2, "725": 2, "30": [2, 4], "ctrl_raw_score_": [2, 18], "i_ctrl": 2, "specifi": [2, 22, 23], "flag_return_ctrl_raw_scor": [2, 23], "true": [2, 4, 15, 18, 20, 23], "ctrl_norm_score_": [2, 12, 18], "flag_return_ctrl_norm_scor": [2, 23], "group": [2, 10, 17, 23], "analysi": [2, 8, 9, 10, 15, 17, 23], "type": [2, 4, 17, 23], "group_analysi": [2, 23], "n_cell": [2, 4, 8, 9, 10, 15, 17, 18], "hetero_mcp": [2, 4], "hetero_mcz": [2, 4], "causal_cel": 2, "04761905": [2, 3], "12": [2, 4], "297529": 2, "non_causal_cel": 2, "9047619": 2, "1364214": 2, "corr_analysi": [2, 23], "corr_mcp": 2, "corr_mcz": 2, "causal_vari": [2, 23], "4574268": 2, "non_causal_vari": [2, 23], "23809524": [2, 3], "8974108": 2, "1904762": 2, "1220891": 2, "var_nam": [2, 4], "corr": [2, 23], "rank": 2, "start": 2, "serping1": 2, "314": 2, "lmna": 2, "278": 2, "scrna": [3, 4], "seq": [3, 4], "gwass": 3, "built": [3, 4], "top": [3, 23], "check": [3, 23], "out": [3, 4, 16, 17, 20, 23], "polygen": 3, "distinguish": [3, 23], "explor": 3, "cellxgen": 3, "git": [3, 24], "clone": [3, 24], "http": [3, 4, 24], "github": [3, 24], "com": [3, 4, 24], "martinjzhang": [3, 24], "cd": [3, 24], "pip": [3, 24], "quick": [3, 24], "m": [3, 24], "pytest": [3, 24], "test_cli": [3, 24], "py": [3, 24], "warn": [3, 4, 24], "via": [3, 4], "pypi": 3, "open": 3, "run": [3, 4, 18], "below": 3, "version": 3, "command": 3, "interfac": 3, "standard": [3, 12], "api": 3, "toi": 3, "comput": [3, 9, 10, 11, 12, 13, 14, 15, 17, 18], "import": [3, 4, 5], "o": [3, 4], "panda": [3, 4, 15, 17, 18], "pd": [3, 4, 8, 9, 10, 22], "data_path": 3, "__path__": 3, "h5ad_fil": [3, 4, 20, 23], "path": [3, 18, 19, 20, 22], "join": 3, "toydata_mous": 3, "cov_fil": [3, 23], "gs_file": [3, 23], "load": [3, 4, 19, 20, 21, 22], "util": [3, 4], "load_h5ad": [3, 4], "flag_filter_data": [3, 4, 20, 23], "fals": [3, 4, 15, 17, 18, 20, 23], "flag_raw_count": [3, 4, 20, 23], "df_cov": [3, 4], "read_csv": [3, 4], "sep": [3, 4], "t": [3, 4, 8, 23], "index_col": [3, 4], "df_g": [3, 4], "load_g": [3, 4], "preproecss": 3, "gene_list": [3, 4, 18, 19], "toydata_gs_mous": 3, "gene_weight": [3, 4, 18], "df_re": [3, 8, 9, 18], "print": [3, 4], "iloc": 3, "expect": [3, 10, 22, 23], "n1": 3, "maa000586": 3, "3_8_m": 3, "741197": 3, "3260064": 3, "0016638935": 3, "7788744": 3, "9357162": 3, "f10": 3, "d041911": 3, "739066": 3, "916272": 3, "a17_b002755_b007347_s17": 3, "mm10": 3, "plu": 3, "6366262": 3, "5523157": 3, "c22_b003856_s298_l004": 3, "mu": 3, "6805663": 3, "2986684": 3, "g12": 3, "b002765": 3, "3_38_f": 3, "640043": 3, "7792473": 3, "h5": 3, "b003278": 3, "4457436": 3, "5613674": 3, "7619048": 3, "687188": 3, "16292442": 3, "48789537": 3, "o14": 3, "maa000570": 3, "4552336": 3, "5821338": 3, "95238096": 3, "9467554": 3, "023762206": 3, "6141763": 3, "j21": 3, "b000634": 3, "3_56_f": 3, "4433637": 3, "3119287": 3, "9916805": 3, "0036282123": 3, "3945906": 3, "e5": 3, "4870768": 3, "1566308": 3, "13311148": 3, "87578446": 3, "1118028": 3, "k20_b000268_b009896_s260": 3, "53548": 3, "1656132": 3, "tutori": [3, 4], "mous": [3, 4, 21, 23], "cortex": [3, 4], "come": 3, "soon": 3, "show": 4, "main": [4, 23], "zeisel": 4, "mu\u00f1oz": 4, "manchado": 4, "2015": 4, "which": [4, 13, 14], "process": 4, "script": 4, "obtain": 4, "scratch": 4, "go": 4, "through": 4, "notebook": 4, "minut": 4, "user": 4, "copi": [4, 17, 18], "get": 4, "familar": 4, "templat": 4, "own": 4, "captur": 4, "download": 4, "precomput": [4, 23], "abov": 4, "wget": 4, "ndownload": 4, "34300925": 4, "zip": 4, "unzip": 4, "mkdir": 4, "mv": 4, "single_cell_data": 4, "zeisel_2015": 4, "rm": 4, "r": 4, "sc": [4, 10, 20, 23], "set_figure_param": 4, "dpi": 4, "125": 4, "scipi": 4, "stat": 4, "numpi": 4, "np": [4, 6, 7, 13, 14, 16, 18], "seaborn": 4, "sn": 4, "matplotlib": 4, "pyplot": 4, "plt": 4, "filterwarn": 4, "ignor": 4, "For": [4, 8, 10, 17, 19, 23], "demonstr": 4, "purpos": 4, "schizophrenia": 4, "demo": 4, "dorsal": 4, "differenti": 4, "ca1": 4, "pyramid": 4, "cembrowski": 4, "2016": 4, "construct": 4, "proxim": 4, "find": 4, "understand": 4, "distribut": [4, 12], "neg": 4, "block": 4, "read_h5ad": 4, "expr": 4, "subset": [4, 23], "loc": 4, "pass_schizophrenia_pardinas2018": 4, "spatial_dors": 4, "ukb_460k": 4, "body_heightz": 4, "renam": 4, "displai": 4, "to_csv": 4, "processed_geneset": 4, "dpyd": 4, "6519": 4, "cacna1i": 4, "4766": 4, "rbfox1": 4, "3247": 4, "ppp1r": 4, "ckb": 4, "fndc5": 4, "lin7b": 4, "gstm7": 4, "tle1": 4, "cabp7": 4, "etv5": 4, "actn1": 4, "sa": 4, "wwox": 4, "bnc2": 4, "gmd": 4, "lpp": 4, "9": 4, "9916": 4, "prkg1": 4, "836": 4, "evalu": 4, "speci": [4, 19, 21, 23], "flag": [4, 23], "filter": [4, 20, 23], "count": [4, 23], "return": [4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], "norm": [4, 23], "folder": [4, 23], "overview": [4, 17], "overlai": 4, "dict_scor": [4, 22], "f": 4, "figsiz": 4, "150": 4, "pl": 4, "color": 4, "level1class": 4, "ncol": 4, "color_map": 4, "rdbu_r": 4, "vmin": 4, "vmax": 4, "kei": [4, 10, 22], "": [4, 6, 7, 8, 11, 12, 23], "highlight": 4, "sever": 4, "panel": 4, "neuron": 4, "ca": 4, "left": 4, "gradient": [4, 8, 23], "area": 4, "combin": 4, "hypothes": 4, "part": 4, "littl": 4, "befor": [4, 14], "dive": 4, "leverag": 4, "exist": 4, "provid": 4, "function": [4, 14, 23], "signific": [4, 12], "n_fdr_0": 4, "significantli": 4, "fdr": [4, 10, 23], "cat": 4, "scdrs_group": [4, 23], "05": [4, 10, 23], "astrocytes_ependym": 4, "224": 4, "1000": [4, 18, 23], "007992008": 4, "755896": 4, "002997003": 4, "0352552": 4, "23": 4, "endotheli": 4, "mural": 4, "235": 4, "14085914": 4, "0441228": 4, "051948052": 4, "8254294": 4, "11": 4, "interneuron": 4, "290": 4, "17982018": 4, "85168266": 4, "005994006": 4, "0294392": 4, "13": 4, "microglia": 4, "98": 4, "43956044": 4, "09781444": 4, "17782217": 4, "9301765": 4, "oligodendrocyt": 4, "820": 4, "7672328": 4, "73165476": 4, "000999001": 4, "0373654": 4, "939": 4, "7077475": 4, "697396": 4, "105": 4, "189": 4, "ss": 4, "399": 4, "78891": 4, "059032": 4, "26": 4, "43": 4, "70": 4, "three": 4, "simulat": 4, "plot_group_stat": 4, "heatmap": 4, "denot": 4, "proport": [4, 10, 17, 23], "squar": 4, "cross": 4, "symbol": [4, 21], "8": 4, "dict_df_stat": 4, "dict_celltype_display_nam": 4, "pyramidal_ca1": 4, "pyramidal_ss": 4, "astrocyt": 4, "fig": 4, "ax": 4, "df_stat": 4, "item": 4, "plot_kw": 4, "cb_fraction": 4, "strongest": 4, "well": 4, "now": 4, "focu": 4, "sourc": [4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22], "extract": 4, "re": 4, "cluster": 4, "adata_ca1": 4, "level2class": 4, "isin": 4, "ca1pyr1": 4, "ca1pyr2": 4, "pp": [4, 10, 18, 20, 23], "filter_cel": [4, 20, 23], "min_gen": [4, 20, 23], "filter_gen": [4, 20, 23], "min_cel": [4, 20, 23], "normalize_tot": 4, "target_sum": 4, "1e4": 4, "log1p": [4, 8, 9, 10, 17, 18, 20, 23], "highly_variable_gen": 4, "min_mean": 4, "0125": 4, "max_mean": 4, "min_disp": 4, "var": [4, 13, 15, 17], "highly_vari": 4, "max_valu": 4, "tl": 4, "pca": 4, "svd_solver": 4, "arpack": 4, "neighbor": [4, 10, 23], "n_neighbor": [4, 10, 23], "n_pc": [4, 10, 23], "40": 4, "n_compon": 4, "assign": [4, 23], "previou": [4, 23], "seem": 4, "more": [4, 23], "obviou": 4, "averag": [4, 18], "against": 4, "quintil": 4, "df_plot": 4, "qcut": 4, "label": 4, "arang": 4, "subplot": 4, "lineplot": 4, "x": [4, 11, 14, 15, 17, 18], "y": 4, "err_styl": 4, "bar": [4, 11], "marker": 4, "set_xtick": 4, "set_xlabel": 4, "set_ylabel": 4, "rigor": 4, "quantifi": 4, "trend": 4, "probabl": 4, "happen": 4, "chanc": 4, "compar": 4, "pearson": [4, 6, 7, 8, 23], "deriv": 4, "inde": 4, "v": [4, 18, 23], "highli": 4, "apart": 4, "essenti": 4, "ani": [4, 23], "paper": 4, "spatial_col": 4, "df_score": 4, "reindex": 4, "ctrl_col": 4, "col": 4, "startswith": 4, "ctrl_norm_scor": 4, "len": 4, "data_r": 4, "pearsonr": 4, "regress": [4, 16, 17], "ctrl_r": 4, "zero": 4, "ctrl_i": 4, "enumer": 4, "sum": 4, "2g": 4, "39": 4, "37": 4, "If": [4, 11, 15, 17, 18, 20, 23], "prefer": 4, "would": 4, "know": 4, "calcul": [4, 11], "achiev": 4, "simpl": 4, "wrapper": 4, "read": [4, 23], "basic": 4, "homolog": [4, 21], "overlap": [4, 22], "dict_g": [4, 19], "src_speci": [4, 19, 21], "dst_speci": [4, 19, 21], "to_intersect": [4, 19], "varianc": [4, 13, 14, 15, 17, 23], "n_mean_bin": [4, 15, 17], "n_var_bin": [4, 15, 17], "14": 4, "dict_df_scor": 4, "dict": [4, 10, 19, 21, 22], "mean_var": [4, 15, 17, 18], "weight_opt": [4, 18, 23], "return_ctrl_raw_scor": [4, 18], "return_ctrl_norm_scor": [4, 18], "verbos": [4, 18], "100": [4, 23], "00": 4, "38": 4, "lt": 4, "25": 4, "70it": 4, "77": 4, "20it": 4, "32": 4, "69it": 4, "ident": 4, "15": [4, 10, 23], "downstream_group_analysi": 4, "df_full_scor": [4, 8, 9, 10, 12], "group_col": [4, 10], "style": 4, "set_capt": 4, "nbsp": 4, "000000": 4, "007992": 4, "002997": 4, "035255": 4, "140859": 4, "044123": 4, "051948": 4, "825429": 4, "179820": 4, "851683": 4, "005994": 4, "029439": 4, "439560": 4, "097814": 4, "177822": 4, "930177": 4, "767233": 4, "731655": 4, "000999": 4, "037365": 4, "707747": 4, "788910": 4, "mat_x": [6, 7, 16], "mat_i": [6, 7, 16], "between": [6, 7, 8, 9, 21, 23], "everi": [6, 7], "paramet": [6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], "ndarrai": [6, 7, 13, 14, 16], "matrix": [6, 7, 13, 14, 17, 19], "shape": [6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18], "m1": [6, 7], "second": [6, 7], "m2": [6, 7], "mat_corr": [6, 7], "spars": [7, 13, 14, 17], "datafram": [8, 9, 10, 12, 15, 17, 18, 22], "var_col": 8, "str": [8, 10, 12, 17, 18, 19, 20, 21, 22, 23], "effector": [8, 23], "mont": [8, 18], "carlo": [8, 18], "assum": [8, 9, 10, 15, 17, 18], "size": [8, 9, 10, 17, 18, 20, 23], "factor": [8, 9, 10, 17, 18, 20, 23], "transform": [8, 9, 10, 14, 17, 18, 20, 23], "contin": 8, "n_var": [8, 14], "n_stat": [8, 9, 10], "fdr_threshold": 10, "float": [10, 11, 23], "connect": [10, 11, 12], "obsp": [10, 11], "dict_df_r": 10, "n_group": [10, 12], "val": 11, "geari": [11, 12, 23], "adopt": 11, "ivirshup": 11, "frac": 11, "sum_": 11, "j": 11, "w_": 11, "x_i": 11, "x_j": 11, "2w": 11, "sum_i": 11, "object": [11, 18], "contain": [11, 12, 17, 19, 22, 23], "graph": [11, 23], "n_ob": [11, 14], "arrai": 11, "dimension": 11, "groupbi": 12, "opt": 12, "control_distribution_match": 12, "must": [12, 19], "option": [12, 17, 18, 20, 23], "similar": 12, "df_rl": 12, "row": 12, "ctrl_mean": 12, "ctrl_sd": 12, "deviat": 12, "sparse_x": 13, "axi": [13, 14, 17], "none": [13, 14, 15, 17, 18, 19, 22, 23], "non": [13, 15, 17], "array_lik": [13, 14, 15, 18], "dens": [13, 14], "default": [13, 14, 15, 17, 18, 19, 23], "along": [13, 14], "length": [13, 14, 15, 18], "v_mean": [13, 14], "vector": [13, 14], "v_var": [13, 14], "transform_func": 14, "n_chunk": [14, 15, 17], "cov_mat": [14, 15, 17, 18], "cov_beta": [14, 15, 17, 18], "cov_gene_mean": [14, 15, 17, 18], "iter": 14, "over": [14, 18], "chunk": [14, 15, 17], "int": [14, 15, 17, 18, 20, 23], "split": [14, 15, 17], "usag": 14, "implicit_cov_corr": 15, "cell_weight": 15, "statstic": 15, "log": [15, 17], "mode": [15, 17, 18], "implicit": [15, 17, 18], "correct": [15, 17, 18], "been": 15, "inform": [15, 17, 18], "un": [15, 17, 18], "scdrs_param": [15, 17, 18], "transformed_x": 15, "bool": [15, 17, 18, 20, 23], "otherwis": [15, 17, 18], "origin": [15, 17], "_get_mean_var_implicit_cov_corr": [15, 17], "df_gene": 15, "var_tech": [15, 17], "technic": [15, 17], "ct_mean": [15, 17], "ct_var": [15, 17], "ct_var_tech": [15, 17], "df_cell": 15, "respons": 16, "n_sampl": 16, "n_respons": 16, "n_covari": 16, "mat_y_resid": 16, "residu": 16, "adj_prop": [17, 23], "includ": 17, "constant": 17, "term": 17, "ad": 17, "back": 17, "oper": [17, 18], "improv": 17, "effici": 17, "replac": 17, "explicitli": 17, "appli": [17, 23], "so": 17, "alwai": 17, "subsequ": 17, "specif": 17, "corrected_x": [17, 18], "where": [17, 18, 23], "invers": [17, 23], "its": 17, "stabil": 17, "smallest": 17, "least": 17, "largest": 17, "n_cov": 17, "75": 17, "present": 17, "sparsiti": 17, "write": [17, 18, 23], "updat": 17, "stai": 17, "untouch": 17, "correctoin": 17, "flag_spars": [17, 18], "flag_cov": [17, 18], "effect": 17, "seri": 17, "gene_stat": [17, 18], "cell_stat": 17, "note": 17, "beta": 17, "resid_x": 17, "save": [17, 18, 23], "gene_mean": 17, "n_genebin": 18, "200": 18, "random_se": 18, "save_intermedi": 18, "requir": [18, 23], "n_disease_gen": 18, "continu": [18, 23], "uniform": [18, 23], "equal": 18, "sqrt": 18, "technical_variance_of_logct": 18, "inv_std": 18, "std": 18, "od": 18, "overdispers": 18, "make": 18, "avoid": 18, "orign": 18, "return_raw_ctrl_scor": 18, "return_norm_ctrl_scor": 18, "random": 18, "seed": 18, "messag": 18, "prefix": 18, "intermedi": 18, "dtype": 18, "float32": 18, "n_kei": 18, "precis": 18, "inaccur": 18, "side": 18, "gs_path": 19, "tab": 19, "unweight": 19, "onli": 19, "gene3": 19, "weight3": 19, "either": 19, "mmusculu": [19, 21, 23], "hsapien": [19, 21, 23], "destin": [19, 21], "intersect": 19, "dictionari": [19, 21, 22], "trait1": 19, "gene_weight_list": 19, "trait2": 19, "250": [20, 23], "human": [21, 23], "One": [21, 23], "cannot": 21, "dic_map": 21, "score_fil": [22, 23], "score_fold": [22, 23], "howev": [22, 23], "less": 22, "than": 22, "skip": 22, "support": 23, "scdrs_cell_corr": 23, "scdrs_gene": 23, "format": 23, "doe": 23, "dash": 23, "underscor": 23, "_": 23, "equival": 23, "out_fold": 23, "compute_scor": 23, "mix": 23, "select": 23, "fwer": 23, "n_max": 23, "cap": 23, "n_min": 23, "out_fil": 23, "000": 23, "max": 23, "threshold": 23, "minimum": 23, "min": 23, "maximum": 23, "exampl": 23, "h5ad_speci": 23, "gs_speci": 23, "magma": 23, "stabliz": 23, "minim": 23, "pass": 23, "depend": 23, "larger": 23, "step": 23, "tissu": 23, "quantil": 23, "cell_typ": 23, "seper": 23, "gene_analysi": 23, "argument": 23, "knn_n_neighbor": 23, "knn": 23, "pipelin": 23, "knn_n_pc": 23, "checkout": 24, "v102": 24, "instal": 24, "pub": 24, "rv1": 24, "initial_submiss": 24, "test_scdr": 24}, "objects": {"": [[5, 0, 0, "-", "scdrs"]], "scdrs.method": [[6, 1, 1, "", "_pearson_corr"], [7, 1, 1, "", "_pearson_corr_sparse"], [8, 1, 1, "", "downstream_corr_analysis"], [9, 1, 1, "", "downstream_gene_analysis"], [10, 1, 1, "", "downstream_group_analysis"], [11, 1, 1, "", "gearys_c"], [12, 1, 1, "", "test_gearysc"]], "scdrs.pp": [[13, 1, 1, "", "_get_mean_var"], [14, 1, 1, "", "_get_mean_var_implicit_cov_corr"], [15, 1, 1, "", "compute_stats"], [16, 1, 1, "", "reg_out"]], "scdrs": [[17, 1, 1, "", "preprocess"], [18, 1, 1, "", "score_cell"]], "scdrs.util": [[19, 1, 1, "", "load_gs"], [20, 1, 1, "", "load_h5ad"], [21, 1, 1, "", "load_homolog_mapping"], [22, 1, 1, "", "load_scdrs_score"]]}, "objtypes": {"0": "py:module", "1": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"]}, "titleterms": {"download": 0, "code": 0, "data": [0, 1, 4, 5], "reproduc": 0, "result": 0, "paper": 0, "other": [0, 1], "version": [0, 24], "faq": 1, "typic": 1, "scdr": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22], "workflow": 1, "which": 1, "gwa": 1, "scrna": 1, "seq": 1, "us": [1, 4], "how": 1, "creat": 1, "magma": 1, "gene": 1, "set": [1, 4], "requir": 1, "size": 1, "comput": [1, 4, 5, 23], "complex": 1, "detect": 1, "few": 1, "signific": 1, "cell": [1, 4], "fdr": 1, "0": [1, 24], "2": [1, 24], "mc": 1, "z": 1, "score": [1, 2, 4, 5, 23], "ar": 1, "much": 1, "more": 1, "than": 1, "p": 1, "valu": 1, "group": [1, 4], "analysi": [1, 4], "due": 1, "limit": 1, "type": 1, "singl": 1, "file": 2, "format": 2, "sumstat": 2, "exampl": [2, 3], "h5ad": 2, "pval_fil": 2, "zscore_fil": 2, "g": [2, 23], "weight": 2, "unweight": 2, "cov": 2, "trait": 2, "gz": 2, "full_scor": 2, "scdrs_group": 2, "annot": 2, "scdrs_cell_corr": 2, "scdrs_gene": 2, "instal": 3, "usag": 3, "quick": 4, "start": 4, "prepar": 4, "diseas": 4, "enrich": 4, "individu": 4, "test": 4, "level": 4, "statist": 4, "between": 4, "variabl": 4, "within": 4, "python": 4, "downstream": [4, 5, 23], "analys": [4, 5], "scz": 4, "document": 5, "load": 5, "util": [5, 19, 20, 21, 22], "method": [6, 7, 8, 9, 10, 11, 12], "_pearson_corr": 6, "_pearson_corr_spars": 7, "downstream_corr_analysi": 8, "downstream_gene_analysi": 9, "downstream_group_analysi": 10, "gearys_c": 11, "test_gearysc": 12, "pp": [13, 14, 15, 16], "_get_mean_var": 13, "_get_mean_var_implicit_cov_corr": 14, "compute_stat": 15, "reg_out": 16, "preprocess": 17, "score_cel": 18, "load_g": 19, "load_h5ad": 20, "load_homolog_map": 21, "load_scdrs_scor": 22, "cli": 23, "mung": 23, "perform": 23, "v1": 24, "091222": 24, "1": 24, "public": 24, "072222": 24, "revis": 24, "030622": 24, "v0": 24, "initi": 24, "submiss": 24, "093022": 24}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "nbsphinx": 4, "sphinx": 58}, "alltitles": {"Downloads": [[0, "downloads"]], "Code and data to reproduce results of the paper": [[0, "code-and-data-to-reproduce-results-of-the-paper"]], "Other versions": [[0, "other-versions"]], "FAQ": [[1, "faq"]], "Typical scDRS workflow": [[1, "typical-scdrs-workflow"]], "Which GWAS and scRNA-seq data to use?": [[1, "which-gwas-and-scrna-seq-data-to-use"]], "How to create MAGMA gene sets?": [[1, "how-to-create-magma-gene-sets"]], "Use scDRS for other gene sets?": [[1, "use-scdrs-for-other-gene-sets"]], "Requirement of gene set size?": [[1, "requirement-of-gene-set-size"]], "Computational complexity?": [[1, "computational-complexity"]], "scDRS detected few significant cells (FDR<0.2)?": [[1, "scdrs-detected-few-significant-cells-fdr-0-2"]], "MC z-scores are much more significant than MC p-values in group analysis due to the MC limit?": [[1, "mc-z-scores-are-much-more-significant-than-mc-p-values-in-group-analysis-due-to-the-mc-limit"]], "Use scDRS for other types of single-cell data?": [[1, "use-scdrs-for-other-types-of-single-cell-data"]], "File formats": [[2, "file-formats"]], ".sumstats": [[2, "sumstats"]], "Example .sumstats file": [[2, "id1"]], ".h5ad": [[2, "h5ad"]], "pval_file,zscore_file": [[2, "pval-file-zscore-file"]], "Example pval_file": [[2, "id2"]], ".gs": [[2, "gs"]], "Example weighted .gs file": [[2, "id3"]], "Example unweighted .gs file": [[2, "id4"]], ".cov": [[2, "cov"]], "Example .cov file": [[2, "id5"]], "<trait>.score.gz": [[2, "trait-score-gz"]], "Example <trait>.score.gz file": [[2, "id6"]], "<trait>.full_score.gz": [[2, "trait-full-score-gz"]], "<trait>.scdrs_group.<annot>": [[2, "trait-scdrs-group-annot"]], "Example <trait>.scdrs_group.<annot> file": [[2, "id7"]], "<trait>.scdrs_cell_corr": [[2, "trait-scdrs-cell-corr"]], "Example <trait>.scdrs_cell_corr file": [[2, "id8"]], "<trait>.scdrs_gene": [[2, "trait-scdrs-gene"]], "Example <trait>.scdrs_gene file": [[2, "id9"]], "scDRS": [[3, "scdrs"]], "Installation": [[3, "installation"]], "Usage": [[3, "usage"]], "Examples": [[3, "examples"]], "Quick start": [[4, "Quick-start"]], "Preparing data sets": [[4, "Preparing-data-sets"]], "scDRS analysis of disease enrichment for individual cells": [[4, "scDRS-analysis-of-disease-enrichment-for-individual-cells"]], "scDRS test of group level statistics": [[4, "scDRS-test-of-group-level-statistics"]], "scDRS test between disease score and cell-level variable": [[4, "scDRS-test-between-disease-score-and-cell-level-variable"]], "Using scDRS within python": [[4, "Using-scDRS-within-python"]], "Preparing data": [[4, "Preparing-data"]], "Computing scDRS scores": [[4, "Computing-scDRS-scores"]], "Downstream analyses for SCZ": [[4, "Downstream-analyses-for-SCZ"]], "Documentation": [[5, "documentation"]], "Compute scDRS score": [[5, "compute-scdrs-score"]], "scDRS downstream analyses": [[5, "scdrs-downstream-analyses"]], "Data loading": [[5, "data-loading"]], "Utils": [[5, "utils"]], "scdrs.method._pearson_corr": [[6, "scdrs-method-pearson-corr"]], "scdrs.method._pearson_corr_sparse": [[7, "scdrs-method-pearson-corr-sparse"]], "scdrs.method.downstream_corr_analysis": [[8, "scdrs-method-downstream-corr-analysis"]], "scdrs.method.downstream_gene_analysis": [[9, "scdrs-method-downstream-gene-analysis"]], "scdrs.method.downstream_group_analysis": [[10, "scdrs-method-downstream-group-analysis"]], "scdrs.method.gearys_c": [[11, "scdrs-method-gearys-c"]], "scdrs.method.test_gearysc": [[12, "scdrs-method-test-gearysc"]], "scdrs.pp._get_mean_var": [[13, "scdrs-pp-get-mean-var"]], "scdrs.pp._get_mean_var_implicit_cov_corr": [[14, "scdrs-pp-get-mean-var-implicit-cov-corr"]], "scdrs.pp.compute_stats": [[15, "scdrs-pp-compute-stats"]], "scdrs.pp.reg_out": [[16, "scdrs-pp-reg-out"]], "scdrs.preprocess": [[17, "scdrs-preprocess"]], "scdrs.score_cell": [[18, "scdrs-score-cell"]], "scdrs.util.load_gs": [[19, "scdrs-util-load-gs"]], "scdrs.util.load_h5ad": [[20, "scdrs-util-load-h5ad"]], "scdrs.util.load_homolog_mapping": [[21, "scdrs-util-load-homolog-mapping"]], "scdrs.util.load_scdrs_score": [[22, "scdrs-util-load-scdrs-score"]], "CLI": [[23, "cli"]], "munge-gs": [[23, "munge-gs"]], "compute-score": [[23, "compute-score"]], "perform-downstream": [[23, "perform-downstream"]], "Versions": [[24, "versions"]], "v1.0.2 (091222)": [[24, "v1-0-2-091222"]], "v1.0.1: publication (072222)": [[24, "v1-0-1-publication-072222"]], "v1.0.0: revision 1 (030622)": [[24, "v1-0-0-revision-1-030622"]], "v0.1: initial submission (093022)": [[24, "v0-1-initial-submission-093022"]]}, "indexentries": {"module": [[5, "module-scdrs"]], "scdrs": [[5, "module-scdrs"]], "_pearson_corr() (in module scdrs.method)": [[6, "scdrs.method._pearson_corr"]], "_pearson_corr_sparse() (in module scdrs.method)": [[7, "scdrs.method._pearson_corr_sparse"]], "downstream_corr_analysis() (in module scdrs.method)": [[8, "scdrs.method.downstream_corr_analysis"]], "downstream_gene_analysis() (in module scdrs.method)": [[9, "scdrs.method.downstream_gene_analysis"]], "downstream_group_analysis() (in module scdrs.method)": [[10, "scdrs.method.downstream_group_analysis"]], "gearys_c() (in module scdrs.method)": [[11, "scdrs.method.gearys_c"]], "test_gearysc() (in module scdrs.method)": [[12, "scdrs.method.test_gearysc"]], "_get_mean_var() (in module scdrs.pp)": [[13, "scdrs.pp._get_mean_var"]], "_get_mean_var_implicit_cov_corr() (in module scdrs.pp)": [[14, "scdrs.pp._get_mean_var_implicit_cov_corr"]], "compute_stats() (in module scdrs.pp)": [[15, "scdrs.pp.compute_stats"]], "reg_out() (in module scdrs.pp)": [[16, "scdrs.pp.reg_out"]], "preprocess() (in module scdrs)": [[17, "scdrs.preprocess"]], "score_cell() (in module scdrs)": [[18, "scdrs.score_cell"]], "load_gs() (in module scdrs.util)": [[19, "scdrs.util.load_gs"]], "load_h5ad() (in module scdrs.util)": [[20, "scdrs.util.load_h5ad"]], "load_homolog_mapping() (in module scdrs.util)": [[21, "scdrs.util.load_homolog_mapping"]], "load_scdrs_score() (in module scdrs.util)": [[22, "scdrs.util.load_scdrs_score"]]}})